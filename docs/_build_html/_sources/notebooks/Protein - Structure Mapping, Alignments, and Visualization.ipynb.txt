{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {
    "nbpresent": {
     "id": "e1808ff9-a178-4fb2-b616-c27a20f62b20"
    }
   },
   "source": [
    "# Protein - Structure Mapping, Alignments, and Visualization\n",
    "This notebook gives an example of how to **map a single protein sequence to its structure**, along with conducting sequence alignments and visualizing the mutations.\n",
    "<p>\n",
    "<div class=\"alert alert-info\">\n",
    "**Input:** Protein ID + amino acid sequence + mutated sequence(s)\n",
    "</div>\n",
    "<div class=\"alert alert-info\">\n",
    "**Output:** Representative protein structure, sequence alignments, and visualization of mutations\n",
    "</div>\n",
    "</p>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbpresent": {
     "id": "a2024d0e-b7a0-4695-9221-2f4bdca8fde4"
    }
   },
   "source": [
    "## Imports"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "import sys\n",
    "import logging"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "collapsed": false,
    "nbpresent": {
     "id": "c7b2d452-50bd-48b5-a1ac-f38865a2173d"
    }
   },
   "outputs": [],
   "source": [
    "# Import the Protein class\n",
    "from ssbio.core.protein import Protein"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "collapsed": true,
    "nbpresent": {
     "id": "f99973a2-f1b7-4dac-8ec7-fabd88ab0db9"
    }
   },
   "outputs": [],
   "source": [
    "# Printing multiple outputs per cell\n",
    "from IPython.core.interactiveshell import InteractiveShell\n",
    "InteractiveShell.ast_node_interactivity = \"all\""
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbpresent": {
     "id": "badf2c2d-127c-4407-adaf-20cae0c1cb9e"
    }
   },
   "source": [
    "### Logging\n",
    "\n",
    "Set the logging level in `logger.setLevel(logging.<LEVEL_HERE>)` to specify how verbose you want the pipeline to be. Debug is most verbose.\n",
    "\n",
    "- `CRITICAL`\n",
    "     - Only really important messages shown\n",
    "- `ERROR`\n",
    "     - Major errors\n",
    "- `WARNING`\n",
    "     - Warnings that don't affect running of the pipeline\n",
    "- `INFO` (default)\n",
    "     - Info such as the number of structures mapped per gene\n",
    "- `DEBUG`\n",
    "     - Really detailed information that will print out a lot of stuff\n",
    "     \n",
    "<p><div class=\"alert alert-warning\">**Warning:** `DEBUG` mode prints out a large amount of information, especially if you have a lot of genes. This may stall your notebook!</div></p>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "# Create logger\n",
    "logger = logging.getLogger()\n",
    "logger.setLevel(logging.INFO)  # SET YOUR LOGGING LEVEL HERE #"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 87,
   "metadata": {
    "collapsed": false,
    "nbpresent": {
     "id": "123feaab-3a42-44fe-93d1-5a6d499d95a0"
    }
   },
   "outputs": [],
   "source": [
    "# Other logger stuff for Jupyter notebooks\n",
    "handler = logging.StreamHandler(sys.stderr)\n",
    "formatter = logging.Formatter('[%(asctime)s] [%(name)s] %(levelname)s: %(message)s', datefmt=\"%Y-%m-%d %H:%M\")\n",
    "handler.setFormatter(formatter)\n",
    "logger.handlers = [handler]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbpresent": {
     "id": "cec7affb-87de-453c-b49c-27d9873ca05c"
    }
   },
   "source": [
    "## Initialization of the project\n",
    "\n",
    "Set these three things:\n",
    "\n",
    "- `ROOT_DIR`\n",
    "    - The directory where a folder named after your `PROTEIN_ID` will be created\n",
    "- `PROTEIN_ID`\n",
    "    - Your protein ID\n",
    "- `PROTEIN_SEQ`\n",
    "    - Your protein sequence\n",
    "    \n",
    "A directory will be created in `ROOT_DIR` with your `PROTEIN_ID` name. The folders are organized like so:\n",
    "```\n",
    "    ROOT_DIR\n",
    "    └── PROTEIN_ID\n",
    "        ├── sequences  # Protein sequence files, alignments, etc.\n",
    "        └── structures  # Protein structure files, calculations, etc.\n",
    "\n",
    "```"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 88,
   "metadata": {
    "collapsed": false,
    "nbpresent": {
     "id": "606dd61f-6350-4a26-b8f6-5d9cabaf4d53"
    }
   },
   "outputs": [],
   "source": [
    "# SET FOLDERS AND DATA HERE\n",
    "import tempfile\n",
    "ROOT_DIR = tempfile.gettempdir()\n",
    "\n",
    "PROTEIN_ID = 'SRR1753782_00918'\n",
    "PROTEIN_SEQ = 'MSKQQIGVVGMAVMGRNLALNIESRGYTVSVFNRSREKTEEVIAENPGKKLVPYYTVKEFVESLETPRRILLMVKAGAGTDAAIDSLKPYLEKGDIIIDGGNTFFQDTIRRNRELSAEGFNFIGTGVSGGEEGALKGPSIMPGGQKDAYELVAPILTKIAAVAEDGEPCVTYIGADGAGHYVKMVHNGIEYGDMQLIAEAYSLLKGGLNLSNEELANTFTEWNNGELSSYLIDITKDIFTKKDEDGNYLVDVILDEAANKGTGKWTSQSALDLGEPLSLITESVFARYISSLKAQRVAASKVLSGPKAQPAGDKAEFIEKVRRALYLGKIVSYAQGFSQLRAASDEYHWDLNYGEIAKIFRAGCIIRAQFLQKITDAYAENADIANLLLAPYFKKIADEYQQALRDVVAYAVQNGIPVPTFSAAVAYYDSYRAAVLPANLIQAQRDYFGAHTYKRTDKEGIFHTEWLE'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 89,
   "metadata": {
    "collapsed": false,
    "nbpresent": {
     "id": "3211664f-c38d-4cf5-8310-b57b5e57562f"
    }
   },
   "outputs": [],
   "source": [
    "# Create the Protein object\n",
    "my_protein = Protein(ident=PROTEIN_ID, root_dir=ROOT_DIR)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 90,
   "metadata": {
    "collapsed": false,
    "nbpresent": {
     "id": "40405d5c-c9e7-4068-9148-551143aa290e"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "DEBUG - [2017-03-06 16:30] [ssbio.core.protein] \"WT: set as representative sequence\"\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<SeqProp WT at 0x7faabd47aa58>"
      ]
     },
     "execution_count": 90,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Load the protein sequence\n",
    "my_protein.load_manual_sequence(seq=PROTEIN_SEQ, ident='WT', write_fasta_file=True, set_as_representative=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbpresent": {
     "id": "6366ff85-88bb-40b2-a548-909dc25f20e5"
    }
   },
   "source": [
    "## Mapping sequence -> structure\n",
    "\n",
    "Since the sequence has been provided, we just need to BLAST it to the PDB.\n",
    "\n",
    "<p><div class=\"alert alert-info\">**Note:** These methods do not download any 3D structure files.</div></p>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbpresent": {
     "id": "e563de4f-c3b1-4863-b983-cffccf44dbe4"
    }
   },
   "source": [
    "### Methods"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbpresent": {
     "id": "18254fcc-caf7-4af9-8c52-51ad78b9b41d"
    }
   },
   "source": [
    "#### `blast_representative_sequence_to_pdb`\n",
    "This will BLAST the representative sequence against the entire PDB, and return significant hits. XML files of the BLAST results are saved in the respective sequence folders for a protein.\n",
    "\n",
    "<p><div class=\"alert alert-info\">**Warning:** A PDB BLAST may return hits in other organisms.</div></p>\n",
    "\n",
    "- `seq_ident_cutoff`\n",
    "    - Default: `0`\n",
    "    - From 0 to 1\n",
    "- `evalue`\n",
    "    - Default: `0.0001`\n",
    "    - Significance of BLAST results\n",
    "- `all_genes`\n",
    "    - Default: `False`\n",
    "    - Set to `True` if you want all genes and their sequences BLASTed\n",
    "    - Set to `False` if you only want to BLAST sequences that did not have any PDBs mapped to them already\n",
    "- `display_link`\n",
    "    - Default: `False`\n",
    "    - Set to `True` if you want a clickable HTML link to be printed\n",
    "- `force_rerun`\n",
    "    - Default: `False`\n",
    "    - Set to `True` if you want to ignore any existing XML results and run the BLAST again\n",
    "- What's saved?\n",
    "    - Protein structures\n",
    "    ```python\n",
    "    my_protein.structures\n",
    "    ```\n",
    "    - DataFrames\n",
    "    ```python\n",
    "    my_protein.df_pdb_blast\n",
    "    ```"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {
    "collapsed": false,
    "nbpresent": {
     "id": "432b3a60-e5a6-4243-852d-fb18bf5ff61a"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2017-03-06 16:25:56,469 ssbio.databases.pdb DEBUG    /tmp/SRR1753782_00918/sequences/WT_blast_pdb.xml: Loaded existing BLAST XML results\n",
      "2017-03-06 16:25:56,469 ssbio.databases.pdb DEBUG    2W90: does not meet sequence identity cutoff\n",
      "2017-03-06 16:25:56,470 ssbio.databases.pdb DEBUG    2W8Z: does not meet sequence identity cutoff\n",
      "2017-03-06 16:25:56,470 ssbio.databases.pdb DEBUG    2IZ1: does not meet sequence identity cutoff\n",
      "2017-03-06 16:25:56,471 ssbio.databases.pdb DEBUG    2IZ0: does not meet sequence identity cutoff\n",
      "2017-03-06 16:25:56,471 ssbio.databases.pdb DEBUG    2IYO: does not meet sequence identity cutoff\n",
      "2017-03-06 16:25:56,472 ssbio.databases.pdb DEBUG    2IYP: does not meet sequence identity cutoff\n",
      "2017-03-06 16:25:56,472 ssbio.databases.pdb DEBUG    2PGD: does not meet sequence identity cutoff\n",
      "2017-03-06 16:25:56,473 ssbio.databases.pdb DEBUG    1PGQ: does not meet sequence identity cutoff\n",
      "2017-03-06 16:25:56,473 ssbio.databases.pdb DEBUG    1PGP: does not meet sequence identity cutoff\n",
      "2017-03-06 16:25:56,474 ssbio.databases.pdb DEBUG    1PGO: does not meet sequence identity cutoff\n",
      "2017-03-06 16:25:56,474 ssbio.databases.pdb DEBUG    1PGN: does not meet sequence identity cutoff\n",
      "2017-03-06 16:25:56,475 ssbio.databases.pdb DEBUG    2JKV: does not meet sequence identity cutoff\n",
      "2017-03-06 16:25:56,475 ssbio.databases.pdb DEBUG    4GWK: does not meet sequence identity cutoff\n",
      "2017-03-06 16:25:56,476 ssbio.databases.pdb DEBUG    4GWG: does not meet sequence identity cutoff\n",
      "2017-03-06 16:25:56,477 ssbio.databases.pdb DEBUG    2P4Q: does not meet sequence identity cutoff\n",
      "2017-03-06 16:25:56,477 ssbio.databases.pdb DEBUG    1PGJ: does not meet sequence identity cutoff\n",
      "2017-03-06 16:25:56,478 ssbio.databases.pdb DEBUG    4E21: does not meet sequence identity cutoff\n",
      "2017-03-06 16:25:56,479 ssbio.databases.pdb DEBUG    5U5G: does not meet sequence identity cutoff\n",
      "2017-03-06 16:25:56,479 ssbio.databases.pdb DEBUG    3WS7: does not meet sequence identity cutoff\n",
      "2017-03-06 16:25:56,480 ssbio.databases.pdb DEBUG    3W6U: does not meet sequence identity cutoff\n",
      "2017-03-06 16:25:56,481 ssbio.databases.pdb DEBUG    3W6Z: does not meet sequence identity cutoff\n",
      "2017-03-06 16:25:56,481 ssbio.databases.pdb DEBUG    2CVZ: does not meet sequence identity cutoff\n",
      "2017-03-06 16:25:56,482 ssbio.databases.pdb DEBUG    1WP4: does not meet sequence identity cutoff\n",
      "2017-03-06 16:25:56,482 ssbio.databases.pdb DEBUG    1VPD: does not meet sequence identity cutoff\n",
      "2017-03-06 16:25:56,483 ssbio.databases.pdb DEBUG    4: Number of BLAST hits\n",
      "2017-03-06 16:25:56,484 ssbio.core.protein DEBUG    SRR1753782_00918: adding 4 PDBs from BLAST results\n",
      "2017-03-06 16:25:56,485 ssbio.structure.structprop DEBUG    A: added to chains list\n",
      "2017-03-06 16:25:56,485 ssbio.structure.structprop DEBUG    A: added to list of mapped chains\n",
      "2017-03-06 16:25:56,486 ssbio.structure.structprop DEBUG    A: chain already present\n",
      "2017-03-06 16:25:56,486 ssbio.core.protein DEBUG    2zyd: PDB ID already present in list of structures\n",
      "2017-03-06 16:25:56,486 ssbio.structure.structprop DEBUG    B: added to list of mapped chains\n",
      "2017-03-06 16:25:56,487 ssbio.structure.structprop DEBUG    B: added to chains list\n",
      "2017-03-06 16:25:56,487 ssbio.structure.structprop DEBUG    A: added to chains list\n",
      "2017-03-06 16:25:56,488 ssbio.structure.structprop DEBUG    A: added to list of mapped chains\n",
      "2017-03-06 16:25:56,488 ssbio.structure.structprop DEBUG    A: chain already present\n",
      "2017-03-06 16:25:56,488 ssbio.core.protein DEBUG    2zya: PDB ID already present in list of structures\n",
      "2017-03-06 16:25:56,489 ssbio.structure.structprop DEBUG    B: added to list of mapped chains\n",
      "2017-03-06 16:25:56,489 ssbio.structure.structprop DEBUG    B: added to chains list\n",
      "2017-03-06 16:25:56,489 ssbio.structure.structprop DEBUG    A: added to chains list\n",
      "2017-03-06 16:25:56,490 ssbio.structure.structprop DEBUG    A: added to list of mapped chains\n",
      "2017-03-06 16:25:56,490 ssbio.structure.structprop DEBUG    A: chain already present\n",
      "2017-03-06 16:25:56,491 ssbio.core.protein DEBUG    3fwn: PDB ID already present in list of structures\n",
      "2017-03-06 16:25:56,491 ssbio.structure.structprop DEBUG    B: added to list of mapped chains\n",
      "2017-03-06 16:25:56,491 ssbio.structure.structprop DEBUG    B: added to chains list\n",
      "2017-03-06 16:25:56,492 ssbio.structure.structprop DEBUG    A: added to chains list\n",
      "2017-03-06 16:25:56,492 ssbio.structure.structprop DEBUG    A: added to list of mapped chains\n",
      "2017-03-06 16:25:56,492 ssbio.structure.structprop DEBUG    A: chain already present\n",
      "2017-03-06 16:25:56,493 ssbio.core.protein DEBUG    2zyg: PDB ID already present in list of structures\n",
      "2017-03-06 16:25:56,493 ssbio.structure.structprop DEBUG    B: added to list of mapped chains\n",
      "2017-03-06 16:25:56,493 ssbio.structure.structprop DEBUG    B: added to chains list\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "['2zyd', '2zya', '3fwn', '2zyg']"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>pdb_chain_id</th>\n",
       "      <th>hit_score</th>\n",
       "      <th>hit_evalue</th>\n",
       "      <th>hit_percent_similar</th>\n",
       "      <th>hit_percent_ident</th>\n",
       "      <th>hit_num_ident</th>\n",
       "      <th>hit_num_similar</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pdb_id</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2zyd</th>\n",
       "      <td>A</td>\n",
       "      <td>2319.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.987179</td>\n",
       "      <td>0.963675</td>\n",
       "      <td>451</td>\n",
       "      <td>462</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2zyd</th>\n",
       "      <td>B</td>\n",
       "      <td>2319.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.987179</td>\n",
       "      <td>0.963675</td>\n",
       "      <td>451</td>\n",
       "      <td>462</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2zya</th>\n",
       "      <td>A</td>\n",
       "      <td>2319.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.987179</td>\n",
       "      <td>0.963675</td>\n",
       "      <td>451</td>\n",
       "      <td>462</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2zya</th>\n",
       "      <td>B</td>\n",
       "      <td>2319.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.987179</td>\n",
       "      <td>0.963675</td>\n",
       "      <td>451</td>\n",
       "      <td>462</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3fwn</th>\n",
       "      <td>A</td>\n",
       "      <td>2312.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.987179</td>\n",
       "      <td>0.963675</td>\n",
       "      <td>451</td>\n",
       "      <td>462</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       pdb_chain_id  hit_score  hit_evalue  hit_percent_similar  \\\n",
       "pdb_id                                                            \n",
       "2zyd              A     2319.0         0.0             0.987179   \n",
       "2zyd              B     2319.0         0.0             0.987179   \n",
       "2zya              A     2319.0         0.0             0.987179   \n",
       "2zya              B     2319.0         0.0             0.987179   \n",
       "3fwn              A     2312.0         0.0             0.987179   \n",
       "\n",
       "        hit_percent_ident  hit_num_ident  hit_num_similar  \n",
       "pdb_id                                                     \n",
       "2zyd             0.963675            451              462  \n",
       "2zyd             0.963675            451              462  \n",
       "2zya             0.963675            451              462  \n",
       "2zya             0.963675            451              462  \n",
       "3fwn             0.963675            451              462  "
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Mapping using BLAST\n",
    "my_protein.blast_representative_sequence_to_pdb(seq_ident_cutoff=0.9, evalue=0.00001)\n",
    "my_protein.df_pdb_blast.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbpresent": {
     "id": "56c859a8-bb18-4901-85e4-143bcdb8cb07"
    }
   },
   "source": [
    "## Downloading and ranking structures"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbpresent": {
     "id": "769939a3-d792-46d0-b152-15be045c908e"
    }
   },
   "source": [
    "### Methods"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbpresent": {
     "id": "3e4188f5-afed-4f48-9f24-7a4284a7ac04"
    }
   },
   "source": [
    "#### `pdb_downloader_and_metadata`\n",
    "Download **all** structures per protein. This also adds metadata to each PDB object in the list of structures.\n",
    "\n",
    "<p><div class=\"alert alert-warning\">**Warning:** Don't run this if you don't need all PDB structures - just set representative structures below if you want 1 structure per protein.</div></p>\n",
    "\n",
    "- `outdir`\n",
    "    - Default: `None`\n",
    "    - Set this to a custom location if you want to save PDB files outside the GEM-PRO project folder\n",
    "- `pdb_file_type`\n",
    "    - Default: `'cif'` (set in Protein initialization, but can be changed here)\n",
    "    - `'pdb'`, `'pdb.gz'`, `'mmcif'`, `'cif'`, `'cif.gz'`, `'xml.gz'`, `'mmtf'`, `'mmtf.gz'` - File type for files downloaded from the PDB.\n",
    "- `force_rerun`\n",
    "    - Default: `False`\n",
    "    - Set to `True` if you want to re-download PDB files.\n",
    "- What's saved?\n",
    "    - Additional metadata per structure\n",
    "    ```python\n",
    "    my_protein.structures\n",
    "    ```\n",
    "    - DataFrames\n",
    "    ```python\n",
    "    my_protein.df_pdb_metadata\n",
    "    ```"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "collapsed": false,
    "nbpresent": {
     "id": "908d11d2-e3a9-4803-b327-9db024698b9e"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['2zyd', '2zya', '3fwn', '2zyg']"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>pdb_title</th>\n",
       "      <th>description</th>\n",
       "      <th>experimental_method</th>\n",
       "      <th>mapped_chains</th>\n",
       "      <th>resolution</th>\n",
       "      <th>chemicals</th>\n",
       "      <th>date</th>\n",
       "      <th>taxonomy_name</th>\n",
       "      <th>structure_file</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>pdb_id</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2zyd</th>\n",
       "      <td>Dimeric 6-phosphogluconate dehydrogenase compl...</td>\n",
       "      <td>6-phosphogluconate dehydrogenase, decarboxylat...</td>\n",
       "      <td>X-RAY DIFFRACTION</td>\n",
       "      <td>A;B</td>\n",
       "      <td>1.5</td>\n",
       "      <td>GLO</td>\n",
       "      <td>2009-09-01;2011-07-13;2014-01-22</td>\n",
       "      <td>Escherichia coli</td>\n",
       "      <td>2zyd.cif</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2zya</th>\n",
       "      <td>Dimeric 6-phosphogluconate dehydrogenase compl...</td>\n",
       "      <td>6-phosphogluconate dehydrogenase, decarboxylat...</td>\n",
       "      <td>X-RAY DIFFRACTION</td>\n",
       "      <td>A;B</td>\n",
       "      <td>1.6</td>\n",
       "      <td>6PG</td>\n",
       "      <td>2009-09-01;2011-07-13;2014-01-22</td>\n",
       "      <td>Escherichia coli</td>\n",
       "      <td>2zya.cif</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                pdb_title  \\\n",
       "pdb_id                                                      \n",
       "2zyd    Dimeric 6-phosphogluconate dehydrogenase compl...   \n",
       "2zya    Dimeric 6-phosphogluconate dehydrogenase compl...   \n",
       "\n",
       "                                              description experimental_method  \\\n",
       "pdb_id                                                                          \n",
       "2zyd    6-phosphogluconate dehydrogenase, decarboxylat...   X-RAY DIFFRACTION   \n",
       "2zya    6-phosphogluconate dehydrogenase, decarboxylat...   X-RAY DIFFRACTION   \n",
       "\n",
       "       mapped_chains  resolution chemicals                              date  \\\n",
       "pdb_id                                                                         \n",
       "2zyd             A;B         1.5       GLO  2009-09-01;2011-07-13;2014-01-22   \n",
       "2zya             A;B         1.6       6PG  2009-09-01;2011-07-13;2014-01-22   \n",
       "\n",
       "           taxonomy_name structure_file  \n",
       "pdb_id                                   \n",
       "2zyd    Escherichia coli       2zyd.cif  \n",
       "2zya    Escherichia coli       2zya.cif  "
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Download all mapped PDBs and gather the metadata\n",
    "my_protein.pdb_downloader_and_metadata()\n",
    "my_protein.df_pdb_metadata.head(2)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbpresent": {
     "id": "c49caf9d-dc39-46b6-ae08-287740bef163"
    }
   },
   "source": [
    "#### `set_representative_structure`\n",
    "Rank available structures, run QC/QA, download and clean the final structure.\n",
    "\n",
    "<p><div class=\"alert alert-info\">**Note:** PDBs don't need to be downloaded before running this step. This is useful to limit the number of structures downloaded from the PDB.</div></p>\n",
    "\n",
    "- `pdb_file_type`\n",
    "    - Default: `'cif'` (set in Protein initialization, but can be changed here)\n",
    "    - `'pdb'`, `'pdb.gz'`, `'mmcif'`, `'cif'`, `'cif.gz'`, `'xml.gz'`, `'mmtf'`, `'mmtf.gz'` - File type for files downloaded from the PDB.\n",
    "- `engine`\n",
    "    - Default: `'needle'`\n",
    "    - Set to `'biopython'` if you want to utilize Biopython's built-in pairwise alignment algorithm.\n",
    "- `always_use_homology`\n",
    "    - Default: `False`\n",
    "    - Set to `True` if you always want to use homology models.\n",
    "- `seq_ident_cutoff`\n",
    "    - Default: `0.5`\n",
    "    - QC/QA: sets the minimum sequence identity a structure has to have to be selected as representative.\n",
    "- `allow_missing_on_termini`\n",
    "    - Default: `0.2`\n",
    "    - QC/QA: Percentage of the total length of the reference sequence which will be ignored when checking for modifications (mutations, deletions, insertions, or unresolved residues). Example: if `0.1`, and reference sequence is 100 AA, then only residues 5 to 95 will be checked for modifications.\n",
    "- `allow_mutants`\n",
    "    - Default: `True`\n",
    "    - QC/QA: set to `True` if point mutations within the structure should be allowed.\n",
    "- `allow_deletions`\n",
    "    - Default: `False`\n",
    "    - QC/QA: set to `True` if deletions within the structure should be allowed.\n",
    "- `allow_insertions`\n",
    "    - Default: `False`\n",
    "    - QC/QA: set to `True` if insertions within the structure should be allowed.\n",
    "- `allow_unresolved`\n",
    "    - Default: `True`\n",
    "    - QC/QA: set to `True` if unresolved regions within the structure should be allowed.\n",
    "- `force_rerun`\n",
    "    - Default: `False`\n",
    "    - QC/QA: set to `True` if pairwise alignments and structure cleaning should be rerun even if files exist.\n",
    "- What's saved?\n",
    "    - Representative protein structures\n",
    "    ```python\n",
    "    my_protein.representative_structure\n",
    "    ```"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "collapsed": false,
    "nbpresent": {
     "id": "b3f297a2-230f-4d61-8dc4-46460b00987b"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<StructProp 2zyd-A at 0x7f0581a5c828>"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set representative structures\n",
    "my_protein.set_representative_structure()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbpresent": {
     "id": "89f851fe-4bc9-446e-9c29-fa98fa816411"
    }
   },
   "source": [
    "## Loading and aligning new sequences\n",
    "\n",
    "You can load additional sequences into this protein object and align them to the representative sequence."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbpresent": {
     "id": "cbe75c19-52d1-49b4-98b7-158b7e740626"
    }
   },
   "source": [
    "### Methods"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbpresent": {
     "id": "d924bffc-2232-4e13-8b6d-38a8fced1f58"
    }
   },
   "source": [
    "#### `load_manual_sequence`\n",
    "Loads in a new sequence string (same as what we used above)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "collapsed": false,
    "nbpresent": {
     "id": "22e5c125-711c-4f76-bac1-32d4817a317a"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<SeqProp N17P_SNP at 0x7fe5246abef0>"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Input your mutated sequence and load it\n",
    "mutated_protein1_id = 'N17P_SNP'\n",
    "mutated_protein1_seq = 'MSKQQIGVVGMAVMGRPLALNIESRGYTVSVFNRSREKTEEVIAENPGKKLVPYYTVKEFVESLETPRRILLMVKAGAGTDAAIDSLKPYLEKGDIIIDGGNTFFQDTIRRNRELSAEGFNFIGTGVSGGEEGALKGPSIMPGGQKDAYELVAPILTKIAAVAEDGEPCVTYIGADGAGHYVKMVHNGIEYGDMQLIAEAYSLLKGGLNLSNEELANTFTEWNNGELSSYLIDITKDIFTKKDEDGNYLVDVILDEAANKGTGKWTSQSALDLGEPLSLITESVFARYISSLKAQRVAASKVLSGPKAQPAGDKAEFIEKVRRALYLGKIVSYAQGFSQLRAASDEYHWDLNYGEIAKIFRAGCIIRAQFLQKITDAYAENADIANLLLAPYFKKIADEYQQALRDVVAYAVQNGIPVPTFSAAVAYYDSYRAAVLPANLIQAQRDYFGAHTYKRTDKEGIFHTEWLE'\n",
    "\n",
    "my_protein.load_manual_sequence(ident=mutated_protein1_id, seq=mutated_protein1_seq)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "collapsed": false,
    "nbpresent": {
     "id": "5520a794-a911-4064-8634-87bd63395838"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<SeqProp Q4S_N17P_SNP at 0x7fe5244fb550>"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Input another mutated sequence and load it\n",
    "mutated_protein2_id = 'Q4S_N17P_SNP'\n",
    "mutated_protein2_seq = 'MSKSQIGVVGMAVMGRPLALNIESRGYTVSVFNRSREKTEEVIAENPGKKLVPYYTVKEFVESLETPRRILLMVKAGAGTDAAIDSLKPYLEKGDIIIDGGNTFFQDTIRRNRELSAEGFNFIGTGVSGGEEGALKGPSIMPGGQKDAYELVAPILTKIAAVAEDGEPCVTYIGADGAGHYVKMVHNGIEYGDMQLIAEAYSLLKGGLNLSNEELANTFTEWNNGELSSYLIDITKDIFTKKDEDGNYLVDVILDEAANKGTGKWTSQSALDLGEPLSLITESVFARYISSLKAQRVAASKVLSGPKAQPAGDKAEFIEKVRRALYLGKIVSYAQGFSQLRAASDEYHWDLNYGEIAKIFRAGCIIRAQFLQKITDAYAENADIANLLLAPYFKKIADEYQQALRDVVAYAVQNGIPVPTFSAAVAYYDSYRAAVLPANLIQAQRDYFGAHTYKRTDKEGIFHTEWLE'\n",
    "\n",
    "my_protein.load_manual_sequence(ident=mutated_protein2_id, seq=mutated_protein2_seq)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbpresent": {
     "id": "882b8625-5e2b-41b2-bdad-233e155b5545"
    }
   },
   "source": [
    "#### `pairwise_align_sequences_to_representative`\n",
    "Conduct **pairwise alignments** of all sequences in the `sequences` attribute to the representative sequence.\n",
    "\n",
    "- `gapopen`\n",
    "    - Default: `10`\n",
    "    - Gap open penalty\n",
    "- `gapextend`\n",
    "    - Default: `0.5`\n",
    "    - Gap extension penalty\n",
    "- `outdir`\n",
    "    - Default: `None`\n",
    "    - Set this to a custom location if you want to save alignment files outside the Protein folder\n",
    "- `engine`\n",
    "    - Default: `'needle'`\n",
    "    - Set to `'biopython'` if you want to utilize Biopython's built-in pairwise alignment algorithm.\n",
    "- `parse`\n",
    "    - Default: `True`\n",
    "    - Parse the results of the pairwise alignments, and store the information as Biopython SeqRecord annotations\n",
    "- `force_rerun`\n",
    "    - Default: `False`\n",
    "    - Set to `True` if pairwise alignments and structure cleaning should be rerun even if files exist.\n",
    "- What's saved?\n",
    "    - Sequence alignments (as `Biopython.Align.MultipleSeqAlignment` objects)\n",
    "    ```python\n",
    "    my_protein.representative_sequence.sequence_alignments\n",
    "    ```"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "collapsed": false,
    "nbpresent": {
     "id": "8397a47d-c06e-4e9b-902a-f0af0a30ba49"
    }
   },
   "outputs": [],
   "source": [
    "# Conduct pairwise sequence alignments\n",
    "my_protein.pairwise_align_sequences_to_representative()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {
    "collapsed": false,
    "nbpresent": {
     "id": "8ed1fc21-6ef5-4a76-bcb2-3e25210632e0"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<<class 'Bio.Align.MultipleSeqAlignment'> instance (2 records of length 468, SingleLetterAlphabet()) at 7fe5244fb6a0>,\n",
       " <<class 'Bio.Align.MultipleSeqAlignment'> instance (2 records of length 468, SingleLetterAlphabet()) at 7fe5244fb9e8>]"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "text/plain": [
       "{'a_seq': 'WT',\n",
       " 'b_seq': 'N17P_SNP',\n",
       " 'deletions': [],\n",
       " 'insertions': [],\n",
       " 'mutations': [('N', 17, 'P')],\n",
       " 'percent_gaps': 0.0,\n",
       " 'percent_identity': 99.8,\n",
       " 'percent_similarity': 99.8,\n",
       " 'score': 2381.0}"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "text/plain": [
       "'MSKQQIGVVGMAVMGRNLALNIESRGYTVSVFNRSREKTEEVIAENPGKKLVPYYTVKEFVESLETPRRILLMVKAGAGTDAAIDSLKPYLEKGDIIIDGGNTFFQDTIRRNRELSAEGFNFIGTGVSGGEEGALKGPSIMPGGQKDAYELVAPILTKIAAVAEDGEPCVTYIGADGAGHYVKMVHNGIEYGDMQLIAEAYSLLKGGLNLSNEELANTFTEWNNGELSSYLIDITKDIFTKKDEDGNYLVDVILDEAANKGTGKWTSQSALDLGEPLSLITESVFARYISSLKAQRVAASKVLSGPKAQPAGDKAEFIEKVRRALYLGKIVSYAQGFSQLRAASDEYHWDLNYGEIAKIFRAGCIIRAQFLQKITDAYAENADIANLLLAPYFKKIADEYQQALRDVVAYAVQNGIPVPTFSAAVAYYDSYRAAVLPANLIQAQRDYFGAHTYKRTDKEGIFHTEWLE'"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "text/plain": [
       "'MSKQQIGVVGMAVMGRPLALNIESRGYTVSVFNRSREKTEEVIAENPGKKLVPYYTVKEFVESLETPRRILLMVKAGAGTDAAIDSLKPYLEKGDIIIDGGNTFFQDTIRRNRELSAEGFNFIGTGVSGGEEGALKGPSIMPGGQKDAYELVAPILTKIAAVAEDGEPCVTYIGADGAGHYVKMVHNGIEYGDMQLIAEAYSLLKGGLNLSNEELANTFTEWNNGELSSYLIDITKDIFTKKDEDGNYLVDVILDEAANKGTGKWTSQSALDLGEPLSLITESVFARYISSLKAQRVAASKVLSGPKAQPAGDKAEFIEKVRRALYLGKIVSYAQGFSQLRAASDEYHWDLNYGEIAKIFRAGCIIRAQFLQKITDAYAENADIANLLLAPYFKKIADEYQQALRDVVAYAVQNGIPVPTFSAAVAYYDSYRAAVLPANLIQAQRDYFGAHTYKRTDKEGIFHTEWLE'"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# View the stored information for one of the alignments\n",
    "my_protein.representative_sequence.sequence_alignments\n",
    "my_protein.representative_sequence.sequence_alignments[0].annotations\n",
    "\n",
    "str(my_protein.representative_sequence.sequence_alignments[0][0].seq)\n",
    "str(my_protein.representative_sequence.sequence_alignments[0][1].seq)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbpresent": {
     "id": "0a5e21d3-a387-41e1-8f74-2f74028413a6"
    }
   },
   "source": [
    "#### `representative_sequence.sequence_mutation_summary`\n",
    "Summarize all mutations found. Returns 2 dictionaries, `single_counter` and `fingerprint_counter`.\n",
    "\n",
    "- `single_counter` is a dictionary of point mutations and a list of sequences the point mutation shows up in.\n",
    "    - Example:\n",
    "    ```python\n",
    "    {('A', 24, 'V'): ['Seq1', 'Seq2', 'Seq4'], \n",
    "    ('R', 33, 'T'): ['Seq2']}\n",
    "    ```\n",
    "- `fingerprint_counter` is a dictionary of groups of point mutations and a list of sequences the groups show up in.\n",
    "    - This reports which sequences have the specific combinations (or \"fingerprints\") of point mutations\n",
    "    - Example: \n",
    "    ```python\n",
    "    {(('A', 24, 'V'), ('R', 33, 'T')): ['Seq2'], \n",
    "    (('A', 24, 'V')): ['Seq1', 'Seq4']}\n",
    "    ```"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {
    "collapsed": false,
    "nbpresent": {
     "id": "8c9b8854-96af-40bd-8084-e6163fbb7c3d"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Single mutations:\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "{('N', 17, 'P'): ['N17P_SNP', 'Q4S_N17P_SNP'], ('Q', 4, 'S'): ['Q4S_N17P_SNP']}"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "---------------------\n",
      "Mutation fingerprints\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "{(('N', 17, 'P'),): ['N17P_SNP'],\n",
       " (('Q', 4, 'S'), ('N', 17, 'P')): ['Q4S_N17P_SNP']}"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Summarize all the mutations in all alignments\n",
    "s,f = my_protein.representative_sequence.sequence_mutation_summary()\n",
    "print('Single mutations:')\n",
    "s\n",
    "print('---------------------')\n",
    "print('Mutation fingerprints')\n",
    "f"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbpresent": {
     "id": "fbae26a5-e369-4f56-8e54-97750f9003f9"
    }
   },
   "source": [
    "## Viewing structures\n",
    "\n",
    "The awesome package [nglview](https://github.com/arose/nglview) is utilized as a backend for viewing structures within a Jupyter notebook. There are many more options which can be set if you run:\n",
    "\n",
    "```python\n",
    "import nglview\n",
    "view = nglview.show_structure_file(my_protein.representative_structure.structure_path)\n",
    "view\n",
    "```\n",
    "\n",
    "`ssbio` provides some wrapper functions to easily view structures and also map sequence residue numbers to structure residue numbers:"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbpresent": {
     "id": "a9b35359-51a9-4fe2-8ee4-11ba5d81dd0e"
    }
   },
   "source": [
    "### Methods"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbpresent": {
     "id": "99c88e5a-d339-4113-bdf2-c30dc19a2d8f"
    }
   },
   "source": [
    "#### `representative_structure.view_structure`\n",
    "View the protein structure.\n",
    "\n",
    "- `opacity`\n",
    "    - Default: `1`\n",
    "    - Opacity of the structure\n",
    "- `gui`\n",
    "    - Default: `False`\n",
    "    - If the NGLview GUI should show up"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {
    "collapsed": false,
    "nbpresent": {
     "id": "80ef68cc-2690-4602-b11f-8f38e8e1773d"
    }
   },
   "outputs": [],
   "source": [
    "# View just the structure\n",
    "my_protein.representative_structure.view_structure()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbpresent": {
     "id": "5758470a-71e4-4e48-a797-dffde6711571"
    }
   },
   "source": [
    "#### `view_all_mutations`\n",
    "Map all sequence alignment mutations to the structure and scale the visualization based on frequency of mutation.\n",
    "\n",
    "- `grouped`\n",
    "    - Default: `False`\n",
    "    - If groups of mutations should be colored and sized together\n",
    "- `color`\n",
    "    - Default: `'red'`\n",
    "    - Color of the mutations (overridden if unique_colors=True)\n",
    "- `unique_colors`\n",
    "    - Default: `True`\n",
    "    - If each mutation/mutation group should be colored uniquely\n",
    "- `structure_opacity`\n",
    "    - Default: `0.5`\n",
    "    - Opacity of the protein structure cartoon representation\n",
    "- `opacity_range`\n",
    "    - Default: `(0.8, 1)`\n",
    "    - Min/max opacity values (mutations that show up more will be opaque)\n",
    "- `scale_range`\n",
    "    - Default: `(1, 5)`\n",
    "    - Min/max size values (mutations that show up more will be bigger)\n",
    "- `gui`\n",
    "    - Default: `False`\n",
    "    - If the NGLview GUI should show up"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {
    "collapsed": false,
    "nbpresent": {
     "id": "dc4b0dd9-bb65-49b7-9146-b0779f2ec306"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:ssbio.structure.structprop:Selection: ( :A ) and not hydrogen and 17\n",
      "INFO:ssbio.structure.structprop:Selection: ( :A ) and not hydrogen and 4\n"
     ]
    }
   ],
   "source": [
    "# Map the mutations on the visualization (scale increased)\n",
    "my_protein.view_all_mutations(scale_range=(4,7))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbpresent": {
     "id": "cb4be353-1615-4767-afdd-1fc637f37c41"
    }
   },
   "source": [
    "#### `representative_structure.view_structure_and_highlight_residues`\n",
    "View any residue on the representative chain (by the structure residue number).\n",
    "\n",
    "<p><div class=\"alert alert-warning\">**Warning:** Sometimes, the residue numbering of a structure doesn't match a mapped sequence. You can use the method in the [next section](#Mapping-sequence-residue-numbers-to-structure-residue-numbers) to easily map residue numbers between the representative sequence and structure. </div></p>\n",
    "\n",
    "- `structure_resnums`\n",
    "    - (int, list): Residue numbers in the structure"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {
    "collapsed": false,
    "nbpresent": {
     "id": "1af74fb5-06a9-469b-8bac-0f2bb6836837"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:ssbio.structure.structprop:Selection: ( :A ) and not hydrogen and ( 1 or 2 or 3 )\n"
     ]
    }
   ],
   "source": [
    "# View just the structure\n",
    "my_protein.representative_structure.view_structure_and_highlight_residues(structure_resnums=[1,2,3])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbpresent": {
     "id": "21c519ff-e117-45ed-9658-6bbd409c4c67"
    }
   },
   "source": [
    "## Mapping sequence residue numbers to structure residue numbers"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbpresent": {
     "id": "62396985-b8cc-43c0-9c1d-0a0f4ff9435a"
    }
   },
   "source": [
    "### Methods"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbpresent": {
     "id": "ccab9877-0d6c-4224-983c-be7b3ce0cf9b"
    }
   },
   "source": [
    "#### `representative_structure.map_repseq_resnums_to_structure_resnums`\n",
    "<p><div class=\"alert alert-info\">**Note:** This method has not been implemented for other chains or other stored structures yet.</div></p>\n",
    "\n",
    "Map a residue number in the reference_seq to the actual structure file's residue number\n",
    "\n",
    "- `resnums`\n",
    "    - (int, list): Residue numbers in the representative sequence"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {
    "collapsed": false,
    "nbpresent": {
     "id": "5b6c97d8-fdc6-40f4-a81e-012d0f70675f"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:ssbio.structure.structprop:2zyd-A, 1: structure file does not contain coordinates for this residue\n",
      "WARNING:ssbio.structure.structprop:2zyd-A, 2: structure file does not contain coordinates for this residue\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "{3: (' ', 3, ' '), 4: (' ', 4, ' ')}"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "my_protein.representative_structure.map_repseq_resnums_to_structure_resnums([1,2,3,4])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Saving"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:ssbio.core.io:Saved <class 'ssbio.core.protein.Protein'> (id: SRR1753782_00918) to /tmp/SRR1753782_00918/protein.json\n"
     ]
    }
   ],
   "source": [
    "import os.path as op\n",
    "my_protein.save_json(op.join(my_protein.protein_dir, 'protein.json'))"
   ]
  }
 ],
 "metadata": {
  "anaconda-cloud": {},
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.5.2"
  },
  "nbpresent": {
   "slides": {
    "157a04b8-becd-45f4-ae6a-d45331b9286d": {
     "id": "157a04b8-becd-45f4-ae6a-d45331b9286d",
     "prev": "5c9e693c-1f0c-4575-bcfc-56402d677e8b",
     "regions": {
      "ba9d0881-51d7-4379-874e-d6393329b3fc": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "a2024d0e-b7a0-4695-9221-2f4bdca8fde4",
        "part": "whole"
       },
       "id": "ba9d0881-51d7-4379-874e-d6393329b3fc"
      }
     }
    },
    "16a7e399-dd0b-4395-b6d3-610f81f66eeb": {
     "id": "16a7e399-dd0b-4395-b6d3-610f81f66eeb",
     "prev": "763127e6-e29a-4b91-b24f-e9fb06a4a10d",
     "regions": {
      "47b84c51-8f60-4ace-96d2-6b2e0ddc117c": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "cbe75c19-52d1-49b4-98b7-158b7e740626",
        "part": "whole"
       },
       "id": "47b84c51-8f60-4ace-96d2-6b2e0ddc117c"
      }
     }
    },
    "18bb9831-7a11-42e0-80f0-9cca2cfa6f3b": {
     "id": "18bb9831-7a11-42e0-80f0-9cca2cfa6f3b",
     "prev": "df3cb41a-0ea2-4b69-a0be-f0123592edf3",
     "regions": {
      "52452efb-3a0b-4046-9ae4-ed9ad94531b5": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "8397a47d-c06e-4e9b-902a-f0af0a30ba49",
        "part": "whole"
       },
       "id": "52452efb-3a0b-4046-9ae4-ed9ad94531b5"
      }
     }
    },
    "224a1535-c07a-4e46-8ea5-77f1cc08f5bd": {
     "id": "224a1535-c07a-4e46-8ea5-77f1cc08f5bd",
     "prev": "663f092f-985e-4932-8a41-b9ccdaeecef6",
     "regions": {
      "b9b48e3e-1100-45d7-9ec6-7a46ff521058": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "b3f297a2-230f-4d61-8dc4-46460b00987b",
        "part": "whole"
       },
       "id": "b9b48e3e-1100-45d7-9ec6-7a46ff521058"
      }
     }
    },
    "232966f7-1f13-4e68-86e6-deba85a5316f": {
     "id": "232966f7-1f13-4e68-86e6-deba85a5316f",
     "prev": "684f642b-ceca-44d6-92af-47d019889a20",
     "regions": {
      "e80b53b9-3901-4429-82af-b3a0c69a857d": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "6366ff85-88bb-40b2-a548-909dc25f20e5",
        "part": "whole"
       },
       "id": "e80b53b9-3901-4429-82af-b3a0c69a857d"
      }
     }
    },
    "27f1e32c-943f-45cc-ab17-c0b355623238": {
     "id": "27f1e32c-943f-45cc-ab17-c0b355623238",
     "prev": "18bb9831-7a11-42e0-80f0-9cca2cfa6f3b",
     "regions": {
      "edcaec32-ac2e-4281-a6b1-2b3fdc1835c9": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "8ed1fc21-6ef5-4a76-bcb2-3e25210632e0",
        "part": "whole"
       },
       "id": "edcaec32-ac2e-4281-a6b1-2b3fdc1835c9"
      }
     }
    },
    "28819a21-efe0-4cc9-a1a9-4b896b0884a6": {
     "id": "28819a21-efe0-4cc9-a1a9-4b896b0884a6",
     "prev": "d10ba35f-ceb9-4265-97ac-4a2c6bf2ac86",
     "regions": {
      "efed7775-a413-4e09-9d64-971a97af1172": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "fbae26a5-e369-4f56-8e54-97750f9003f9",
        "part": "whole"
       },
       "id": "efed7775-a413-4e09-9d64-971a97af1172"
      }
     }
    },
    "2a0a4198-c98f-493c-8235-faf97ee5cb74": {
     "id": "2a0a4198-c98f-493c-8235-faf97ee5cb74",
     "prev": "d751ef97-9379-4c87-8f08-a3335b6ef8c7",
     "regions": {
      "56964d6b-f159-4dcc-bac8-021107bcd10b": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "1af74fb5-06a9-469b-8bac-0f2bb6836837",
        "part": "whole"
       },
       "id": "56964d6b-f159-4dcc-bac8-021107bcd10b"
      }
     }
    },
    "350fdc11-888a-4200-ad84-08a273ba94a1": {
     "id": "350fdc11-888a-4200-ad84-08a273ba94a1",
     "prev": "59d43bdd-463e-4d81-84d2-42757ee47833",
     "regions": {
      "c2604f4b-068e-4aa7-9400-98c77a1cb1f2": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "ccab9877-0d6c-4224-983c-be7b3ce0cf9b",
        "part": "whole"
       },
       "id": "c2604f4b-068e-4aa7-9400-98c77a1cb1f2"
      }
     }
    },
    "3b4a2e49-f9bc-491a-8b87-a208a6cb2d83": {
     "id": "3b4a2e49-f9bc-491a-8b87-a208a6cb2d83",
     "prev": "cb9331a2-31f7-45e4-ad1a-556be0662da2",
     "regions": {
      "0453d5c2-7293-42d0-bd5b-c2631d1cc2cf": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "18254fcc-caf7-4af9-8c52-51ad78b9b41d",
        "part": "whole"
       },
       "id": "0453d5c2-7293-42d0-bd5b-c2631d1cc2cf"
      }
     }
    },
    "48b00f0e-9432-461d-95bf-50d69b5a2abb": {
     "id": "48b00f0e-9432-461d-95bf-50d69b5a2abb",
     "prev": "70c85326-d481-4473-ae39-994640afb4dc",
     "regions": {
      "be7f84c4-59a2-4ea2-a644-92a56c9bd267": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "22e5c125-711c-4f76-bac1-32d4817a317a",
        "part": "whole"
       },
       "id": "be7f84c4-59a2-4ea2-a644-92a56c9bd267"
      }
     }
    },
    "5572bb9e-f50b-453f-ab6b-3801943c08b4": {
     "id": "5572bb9e-f50b-453f-ab6b-3801943c08b4",
     "prev": "93a7de3d-d912-4daf-8c1f-18365f14ee52",
     "regions": {
      "370adc73-2475-4871-9b26-ca67d32c63c8": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "80ef68cc-2690-4602-b11f-8f38e8e1773d",
        "part": "whole"
       },
       "id": "370adc73-2475-4871-9b26-ca67d32c63c8"
      }
     }
    },
    "58bc09f4-ddac-4105-93a9-46e3b52e658b": {
     "id": "58bc09f4-ddac-4105-93a9-46e3b52e658b",
     "prev": "fc8ce3da-0e4c-4e21-b229-354c5e42c944",
     "regions": {
      "da309218-2aef-4308-980f-8d438a070121": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "cec7affb-87de-453c-b49c-27d9873ca05c",
        "part": "whole"
       },
       "id": "da309218-2aef-4308-980f-8d438a070121"
      }
     }
    },
    "59d43bdd-463e-4d81-84d2-42757ee47833": {
     "id": "59d43bdd-463e-4d81-84d2-42757ee47833",
     "prev": "ccb44894-4ff9-4061-9680-0b29a24fe71d",
     "regions": {
      "8b10023e-d096-444b-92b7-9d9f1a5230cb": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "62396985-b8cc-43c0-9c1d-0a0f4ff9435a",
        "part": "whole"
       },
       "id": "8b10023e-d096-444b-92b7-9d9f1a5230cb"
      }
     }
    },
    "5c9e693c-1f0c-4575-bcfc-56402d677e8b": {
     "id": "5c9e693c-1f0c-4575-bcfc-56402d677e8b",
     "prev": null,
     "regions": {
      "adc09205-beb7-4cbd-bdf1-3e571359f39c": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "id": "adc09205-beb7-4cbd-bdf1-3e571359f39c"
      }
     },
     "theme": null
    },
    "663f092f-985e-4932-8a41-b9ccdaeecef6": {
     "id": "663f092f-985e-4932-8a41-b9ccdaeecef6",
     "prev": "a3c91bd5-22dd-46eb-8bfb-b9c798f8ed3a",
     "regions": {
      "d548f4fc-6175-4cce-a453-4e88f2fe8161": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "c49caf9d-dc39-46b6-ae08-287740bef163",
        "part": "whole"
       },
       "id": "d548f4fc-6175-4cce-a453-4e88f2fe8161"
      }
     }
    },
    "684f642b-ceca-44d6-92af-47d019889a20": {
     "id": "684f642b-ceca-44d6-92af-47d019889a20",
     "prev": "ba8f8326-e3cc-4c5b-9c45-c7980ddaf7b8",
     "regions": {
      "e42315ee-eb77-4452-ba1b-130a23abe7aa": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "40405d5c-c9e7-4068-9148-551143aa290e",
        "part": "whole"
       },
       "id": "e42315ee-eb77-4452-ba1b-130a23abe7aa"
      }
     }
    },
    "685ba19d-ea3a-4957-806c-58fb08b813ea": {
     "id": "685ba19d-ea3a-4957-806c-58fb08b813ea",
     "prev": "a45bc057-2dce-435e-986e-e3dc0afcfc5a",
     "regions": {
      "4cfe3247-dbb2-4e0f-b44e-fa4e398462d2": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "3e4188f5-afed-4f48-9f24-7a4284a7ac04",
        "part": "whole"
       },
       "id": "4cfe3247-dbb2-4e0f-b44e-fa4e398462d2"
      }
     }
    },
    "695da414-9d23-430c-aa41-2261a39a4487": {
     "id": "695da414-9d23-430c-aa41-2261a39a4487",
     "prev": "3b4a2e49-f9bc-491a-8b87-a208a6cb2d83",
     "regions": {
      "61933a72-30f3-47e6-8677-0ed7ba82c288": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "432b3a60-e5a6-4243-852d-fb18bf5ff61a",
        "part": "whole"
       },
       "id": "61933a72-30f3-47e6-8677-0ed7ba82c288"
      }
     }
    },
    "69b9f2c1-9f7d-4455-a092-d462f37e38c3": {
     "id": "69b9f2c1-9f7d-4455-a092-d462f37e38c3",
     "prev": "28819a21-efe0-4cc9-a1a9-4b896b0884a6",
     "regions": {
      "166c899c-f561-4087-b24e-434f23fbffcc": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "a9b35359-51a9-4fe2-8ee4-11ba5d81dd0e",
        "part": "whole"
       },
       "id": "166c899c-f561-4087-b24e-434f23fbffcc"
      }
     }
    },
    "70c85326-d481-4473-ae39-994640afb4dc": {
     "id": "70c85326-d481-4473-ae39-994640afb4dc",
     "prev": "16a7e399-dd0b-4395-b6d3-610f81f66eeb",
     "regions": {
      "92685a8e-4ef3-4520-b8a0-88d3be23abd0": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "d924bffc-2232-4e13-8b6d-38a8fced1f58",
        "part": "whole"
       },
       "id": "92685a8e-4ef3-4520-b8a0-88d3be23abd0"
      }
     }
    },
    "763127e6-e29a-4b91-b24f-e9fb06a4a10d": {
     "id": "763127e6-e29a-4b91-b24f-e9fb06a4a10d",
     "prev": "224a1535-c07a-4e46-8ea5-77f1cc08f5bd",
     "regions": {
      "db3cf4bd-06ce-41ad-8548-fd88142f65c7": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "89f851fe-4bc9-446e-9c29-fa98fa816411",
        "part": "whole"
       },
       "id": "db3cf4bd-06ce-41ad-8548-fd88142f65c7"
      }
     }
    },
    "7af1b790-96b3-4325-b4b1-fb74c9405595": {
     "id": "7af1b790-96b3-4325-b4b1-fb74c9405595",
     "prev": "350fdc11-888a-4200-ad84-08a273ba94a1",
     "regions": {
      "6d1cbcf6-a57b-4263-b5d4-8c2f8d58b94a": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "5b6c97d8-fdc6-40f4-a81e-012d0f70675f",
        "part": "whole"
       },
       "id": "6d1cbcf6-a57b-4263-b5d4-8c2f8d58b94a"
      }
     }
    },
    "7eacc7b5-bb2c-4136-adee-898d99f1b1c0": {
     "id": "7eacc7b5-bb2c-4136-adee-898d99f1b1c0",
     "prev": "695da414-9d23-430c-aa41-2261a39a4487",
     "regions": {
      "1f1f3c8f-8ada-4928-a64d-1ac8a2e9a6b2": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "56c859a8-bb18-4901-85e4-143bcdb8cb07",
        "part": "whole"
       },
       "id": "1f1f3c8f-8ada-4928-a64d-1ac8a2e9a6b2"
      }
     }
    },
    "93a7de3d-d912-4daf-8c1f-18365f14ee52": {
     "id": "93a7de3d-d912-4daf-8c1f-18365f14ee52",
     "prev": "69b9f2c1-9f7d-4455-a092-d462f37e38c3",
     "regions": {
      "54883a17-907c-4138-9814-9a04582e3af0": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "99c88e5a-d339-4113-bdf2-c30dc19a2d8f",
        "part": "whole"
       },
       "id": "54883a17-907c-4138-9814-9a04582e3af0"
      }
     }
    },
    "a3c91bd5-22dd-46eb-8bfb-b9c798f8ed3a": {
     "id": "a3c91bd5-22dd-46eb-8bfb-b9c798f8ed3a",
     "prev": "685ba19d-ea3a-4957-806c-58fb08b813ea",
     "regions": {
      "80e137ea-d00f-4c26-ab33-5bc35363039e": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "908d11d2-e3a9-4803-b327-9db024698b9e",
        "part": "whole"
       },
       "id": "80e137ea-d00f-4c26-ab33-5bc35363039e"
      }
     }
    },
    "a45bc057-2dce-435e-986e-e3dc0afcfc5a": {
     "id": "a45bc057-2dce-435e-986e-e3dc0afcfc5a",
     "prev": "7eacc7b5-bb2c-4136-adee-898d99f1b1c0",
     "regions": {
      "2a547cb1-0f2f-4ef4-b498-0f15e3214b94": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "769939a3-d792-46d0-b152-15be045c908e",
        "part": "whole"
       },
       "id": "2a547cb1-0f2f-4ef4-b498-0f15e3214b94"
      }
     }
    },
    "a7b3c13e-cf5a-46cd-9345-5aa6546b7d13": {
     "id": "a7b3c13e-cf5a-46cd-9345-5aa6546b7d13",
     "prev": "48b00f0e-9432-461d-95bf-50d69b5a2abb",
     "regions": {
      "6d88dfd2-d4b5-4fb5-a368-2b9f7a83bb70": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "5520a794-a911-4064-8634-87bd63395838",
        "part": "whole"
       },
       "id": "6d88dfd2-d4b5-4fb5-a368-2b9f7a83bb70"
      }
     }
    },
    "a881c8cd-9cb6-4414-a2e4-a741ad6b5788": {
     "id": "a881c8cd-9cb6-4414-a2e4-a741ad6b5788",
     "prev": "5572bb9e-f50b-453f-ab6b-3801943c08b4",
     "regions": {
      "25d7afe8-7e49-4c32-88b8-aaa9adc34caf": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "5758470a-71e4-4e48-a797-dffde6711571",
        "part": "whole"
       },
       "id": "25d7afe8-7e49-4c32-88b8-aaa9adc34caf"
      }
     }
    },
    "b5ffb0b9-32d8-409a-a17f-c3b34d4ecd4e": {
     "id": "b5ffb0b9-32d8-409a-a17f-c3b34d4ecd4e",
     "prev": "f1a62424-903e-4733-ad5d-1ec7603394b4",
     "regions": {
      "e6aa0004-b081-4dca-820a-d655a1184af4": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "f99973a2-f1b7-4dac-8ec7-fabd88ab0db9",
        "part": "whole"
       },
       "id": "e6aa0004-b081-4dca-820a-d655a1184af4"
      }
     }
    },
    "ba8f8326-e3cc-4c5b-9c45-c7980ddaf7b8": {
     "id": "ba8f8326-e3cc-4c5b-9c45-c7980ddaf7b8",
     "prev": "faf996c1-ab90-4e21-9210-02ab341ff7ee",
     "regions": {
      "1bd6f438-a1cb-4b11-895c-fa04c1c32fa1": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "3211664f-c38d-4cf5-8310-b57b5e57562f",
        "part": "whole"
       },
       "id": "1bd6f438-a1cb-4b11-895c-fa04c1c32fa1"
      }
     }
    },
    "cafc0d85-e53a-4cea-9ace-de54833a78a0": {
     "id": "cafc0d85-e53a-4cea-9ace-de54833a78a0",
     "prev": "27f1e32c-943f-45cc-ab17-c0b355623238",
     "regions": {
      "6398e15d-dc32-4709-8fb6-0ce870f378aa": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "0a5e21d3-a387-41e1-8f74-2f74028413a6",
        "part": "whole"
       },
       "id": "6398e15d-dc32-4709-8fb6-0ce870f378aa"
      }
     }
    },
    "cb9331a2-31f7-45e4-ad1a-556be0662da2": {
     "id": "cb9331a2-31f7-45e4-ad1a-556be0662da2",
     "prev": "232966f7-1f13-4e68-86e6-deba85a5316f",
     "regions": {
      "bc6a08c2-b6f9-4089-8bc1-2244b31c3047": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "e563de4f-c3b1-4863-b983-cffccf44dbe4",
        "part": "whole"
       },
       "id": "bc6a08c2-b6f9-4089-8bc1-2244b31c3047"
      }
     }
    },
    "ccb44894-4ff9-4061-9680-0b29a24fe71d": {
     "id": "ccb44894-4ff9-4061-9680-0b29a24fe71d",
     "prev": "2a0a4198-c98f-493c-8235-faf97ee5cb74",
     "regions": {
      "94325aab-50e6-4ac0-a94e-af9e2ddd35d0": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "21c519ff-e117-45ed-9658-6bbd409c4c67",
        "part": "whole"
       },
       "id": "94325aab-50e6-4ac0-a94e-af9e2ddd35d0"
      }
     }
    },
    "d10ba35f-ceb9-4265-97ac-4a2c6bf2ac86": {
     "id": "d10ba35f-ceb9-4265-97ac-4a2c6bf2ac86",
     "prev": "cafc0d85-e53a-4cea-9ace-de54833a78a0",
     "regions": {
      "9f80f4e2-1900-4b9b-8f4e-414eba159966": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "8c9b8854-96af-40bd-8084-e6163fbb7c3d",
        "part": "whole"
       },
       "id": "9f80f4e2-1900-4b9b-8f4e-414eba159966"
      }
     }
    },
    "d751ef97-9379-4c87-8f08-a3335b6ef8c7": {
     "id": "d751ef97-9379-4c87-8f08-a3335b6ef8c7",
     "prev": "f0065a19-f8a5-4b66-be56-1d7d373b7f5e",
     "regions": {
      "70d0bdb8-9a36-47e4-906d-ec11d4f01a18": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "cb4be353-1615-4767-afdd-1fc637f37c41",
        "part": "whole"
       },
       "id": "70d0bdb8-9a36-47e4-906d-ec11d4f01a18"
      }
     }
    },
    "df3cb41a-0ea2-4b69-a0be-f0123592edf3": {
     "id": "df3cb41a-0ea2-4b69-a0be-f0123592edf3",
     "prev": "a7b3c13e-cf5a-46cd-9345-5aa6546b7d13",
     "regions": {
      "f97e4a35-5c15-4383-b69d-9744f5ae6fc4": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "882b8625-5e2b-41b2-bdad-233e155b5545",
        "part": "whole"
       },
       "id": "f97e4a35-5c15-4383-b69d-9744f5ae6fc4"
      }
     }
    },
    "ef853f2f-35c8-41e5-96dd-23d3420b64b8": {
     "id": "ef853f2f-35c8-41e5-96dd-23d3420b64b8",
     "prev": "b5ffb0b9-32d8-409a-a17f-c3b34d4ecd4e",
     "regions": {
      "2de28ef3-58d1-4002-992d-a593270b900f": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "badf2c2d-127c-4407-adaf-20cae0c1cb9e",
        "part": "whole"
       },
       "id": "2de28ef3-58d1-4002-992d-a593270b900f"
      }
     }
    },
    "f0065a19-f8a5-4b66-be56-1d7d373b7f5e": {
     "id": "f0065a19-f8a5-4b66-be56-1d7d373b7f5e",
     "prev": "a881c8cd-9cb6-4414-a2e4-a741ad6b5788",
     "regions": {
      "073007c4-e42a-4c27-b3df-afbb1b356413": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "dc4b0dd9-bb65-49b7-9146-b0779f2ec306",
        "part": "whole"
       },
       "id": "073007c4-e42a-4c27-b3df-afbb1b356413"
      }
     }
    },
    "f1a62424-903e-4733-ad5d-1ec7603394b4": {
     "id": "f1a62424-903e-4733-ad5d-1ec7603394b4",
     "prev": "157a04b8-becd-45f4-ae6a-d45331b9286d",
     "regions": {
      "9634aa1e-770c-443e-8cd0-530a5ecf056f": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "c7b2d452-50bd-48b5-a1ac-f38865a2173d",
        "part": "whole"
       },
       "id": "9634aa1e-770c-443e-8cd0-530a5ecf056f"
      }
     }
    },
    "faf996c1-ab90-4e21-9210-02ab341ff7ee": {
     "id": "faf996c1-ab90-4e21-9210-02ab341ff7ee",
     "prev": "58bc09f4-ddac-4105-93a9-46e3b52e658b",
     "regions": {
      "b80a2ad9-4592-48e8-a374-20d35dc13a04": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "606dd61f-6350-4a26-b8f6-5d9cabaf4d53",
        "part": "whole"
       },
       "id": "b80a2ad9-4592-48e8-a374-20d35dc13a04"
      }
     }
    },
    "fc8ce3da-0e4c-4e21-b229-354c5e42c944": {
     "id": "fc8ce3da-0e4c-4e21-b229-354c5e42c944",
     "prev": "ef853f2f-35c8-41e5-96dd-23d3420b64b8",
     "regions": {
      "ba1e3a65-a4fc-4996-9bcd-e85c1cf699e2": {
       "attrs": {
        "height": 0.8,
        "width": 0.8,
        "x": 0.1,
        "y": 0.1
       },
       "content": {
        "cell": "123feaab-3a42-44fe-93d1-5a6d499d95a0",
        "part": "whole"
       },
       "id": "ba1e3a65-a4fc-4996-9bcd-e85c1cf699e2"
      }
     }
    }
   },
   "themes": {}
  },
  "widgets": {
   "state": {
    "16008620ad704e7086c3dceafad2e9c8": {
     "views": [
      {
       "cell_index": 34
      }
     ]
    },
    "21a45d2136f94d099478c5c1db4ef63d": {
     "views": [
      {
       "cell_index": 34
      }
     ]
    },
    "2316cc103f1e41789a0e1abf52113756": {
     "views": [
      {
       "cell_index": 35
      }
     ]
    },
    "314281feab514e418fd33e9cb9820cba": {
     "views": [
      {
       "cell_index": 33
      }
     ]
    },
    "3420fd203c9e4908978657f54e4506a4": {
     "views": [
      {
       "cell_index": 37
      }
     ]
    },
    "34648c0e75a044bc8c772605d7d25043": {
     "views": [
      {
       "cell_index": 34
      }
     ]
    },
    "35ccaf4566034d9297f7496795327d10": {
     "views": [
      {
       "cell_index": 37
      }
     ]
    },
    "4e12559f9489440fbe6b681284f7cc9d": {
     "views": [
      {
       "cell_index": 38
      }
     ]
    },
    "5c64d515a0ad4a7aaff662d5bbe506d6": {
     "views": [
      {
       "cell_index": 37
      }
     ]
    },
    "5eab5ddda2f7477caa72d744cda90173": {
     "views": [
      {
       "cell_index": 33
      }
     ]
    },
    "734b36085b304d118997520c87b37570": {
     "views": [
      {
       "cell_index": 36
      }
     ]
    },
    "809598ab40b944469df178345a3b3b2e": {
     "views": [
      {
       "cell_index": 35
      }
     ]
    },
    "83b91ce247914305bc7291c794f77e47": {
     "views": [
      {
       "cell_index": 33
      }
     ]
    },
    "8659b3d7735042faa850ae05eff7e17d": {
     "views": [
      {
       "cell_index": 37
      }
     ]
    },
    "871a0f8de25a4749a33bc2216439baca": {
     "views": [
      {
       "cell_index": 37
      }
     ]
    },
    "8d49d76a8f734a8a9e7b960b0e1b39a5": {
     "views": [
      {
       "cell_index": 36
      }
     ]
    },
    "9c360c3b4da04708927900d79c231045": {
     "views": [
      {
       "cell_index": 39
      }
     ]
    },
    "a1c2309409db4ab08f4297353b8c6dd2": {
     "views": [
      {
       "cell_index": 33
      }
     ]
    },
    "aa3688474c8444aebc990458afc17489": {
     "views": [
      {
       "cell_index": 35
      }
     ]
    },
    "ae85d88be5094fab932684fd6dcc64e5": {
     "views": [
      {
       "cell_index": 35
      }
     ]
    },
    "b1846fd1186946b883ca2f6d3c1f782e": {
     "views": [
      {
       "cell_index": 37
      }
     ]
    },
    "b2a4079dc96d4b1aa6eed4713a0ea736": {
     "views": [
      {
       "cell_index": 35
      }
     ]
    },
    "b4743ce41d6848ab9ee483bc22f66ac2": {
     "views": [
      {
       "cell_index": 37
      }
     ]
    },
    "bb63dbcdaedd4e4397ba058c9f1b4c88": {
     "views": [
      {
       "cell_index": 37
      }
     ]
    },
    "bb7ebaeb3da1400fb018e66609bf06b8": {
     "views": [
      {
       "cell_index": 33
      }
     ]
    },
    "be90816e3e8545f5a0aaf948c04d9323": {
     "views": [
      {
       "cell_index": 33
      }
     ]
    },
    "c2a0f512619541f0abcf0f20bb07714b": {
     "views": [
      {
       "cell_index": 35
      }
     ]
    },
    "cc65465af5b4436aafcdf30c53f29380": {
     "views": [
      {
       "cell_index": 38
      }
     ]
    },
    "d13d21b665094f4b85c207d994827d69": {
     "views": [
      {
       "cell_index": 37
      }
     ]
    },
    "d8df2c774428445a9251cfb176389d3a": {
     "views": [
      {
       "cell_index": 33
      }
     ]
    },
    "ded72806cedd4cd0ba6aeec660ef1380": {
     "views": [
      {
       "cell_index": 35
      }
     ]
    },
    "ee8d8ff1872645ffa4ce73d9cc91630d": {
     "views": [
      {
       "cell_index": 36
      }
     ]
    },
    "ef8e5c9a355f4d8d8c80a5774a57b45a": {
     "views": [
      {
       "cell_index": 38
      }
     ]
    },
    "f677e579337e43fe8fde6a52c320e4e4": {
     "views": [
      {
       "cell_index": 33
      }
     ]
    },
    "f991be85df1a4e5d9c1eae3714b61b0a": {
     "views": [
      {
       "cell_index": 35
      }
     ]
    },
    "fd1e2c83299149a7b1b5bf306b305509": {
     "views": [
      {
       "cell_index": 35
      }
     ]
    }
   },
   "version": "1.2.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
